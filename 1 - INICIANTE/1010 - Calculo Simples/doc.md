tentei fazer a verção mais obvia primeiro, é bem simples e acredito que a forma de input/map não altera no desempenho (não validei isso ainda).

não satisfeito tentei outras formas;
a segunda eu sseparo a conta final em dois e fica o doblo mais eficiente, ainda não satisfeito eu coloquei de uma forma ainda mais elaborada na verção 3/4/5.

eu declaro como empate a verção 2, junto com a 3 e a 5.
acredito que, na escalabilidade a 5 deve ser superior a 3, pelo fato de que a 2 é melhor que a 1.
a 2 não é escalável de forma nenhuma.

visto que ainda não fiquei satisfeito, achando que o sistema tinha demorado para aquecer, e tentei rodas a v1 novamente e foi muito pior.